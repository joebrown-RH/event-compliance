---
- name: Rescue a possible comprimised  Account system
  hosts: rhel
  gather_facts: true
  become: true

  vars:
   my_repo: system_resources.git
   my_repo_host: github.com
   my_repo_user: nmartins0611
   my_repo_url: git@{{ my_repo_host }}:{{ my_repo_user }}/{{ my_repo }}
   my_repo_key: /Users/nmart/.ssh/id_rsa

  tasks:
   
   - name: Retreive user files
     git:
      repo: https://github.com/nmartins0611/system_resources
      dest: /restore
      clone: yes
 
   - name: Restore desired user database files
     copy: 
      src:  /restore/passwd
      dest: /etc/
      owner: root
      group: root
      mode: 644
      remote_src: yes

   - name: Restore desired user database files
     copy: 
      src:  /restore/shadow
      dest: /etc/
      owner: root
      group: root
      mode: 644
      remote_src: yes

   - name: Cleanup 
     file:
       path: /restore
       state: absent 
